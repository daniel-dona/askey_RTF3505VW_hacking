<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
      <link rel="stylesheet" href='colors.css' type='text/css'>
      <script language="javascript" src="util.js"></script>
<script language="javascript">
<!-- hide

function btnApply() {
   var loc = 'password.cgi?';

   with ( document.forms[0] ) {
      if ( pwdNew.value == pwdOld.value ) {
         alert("Invalid New password");
         return;
      }

      if ( pwdNew.value != pwdCfm.value ) {
         alert("The passwords do not match.");
         return;
      }

      var str = new String();
      str = pwdNew.value;
      if ( str.length < 8 ) {
         alert('Password must be 8 ~ 32 characters.');
         return;
      }
      var checkspc = /(^ |  | $)/;
      var checkpwd = /^[\x20-\x7e]{8,32}$/;
      if (!checkpwd.test(str) || checkspc.test(str)) {
         alert('Your password access router contains invalid characters. Remember that you can not enter spaces at the beginning or end of the password. Nor enter multiple consecutive spaces.');
         return;
      }
      loc += 'inUserName=<%ejGet(curUserName)%>';
      loc += '&inPassword=' + encodeUrl(pwdNew.value);
      loc += '&inOrgPassword=' + encodeUrl(pwdOld.value);
      loc += '&sessionKey=<%ejGetOther(sessionKey)%>';

      var code = 'location="' + loc + '"';
      eval(code);
   }
}

function checkLength(pwd) {
   if (pwd.value.length > 32) {
      alert("The length exceeds 32 characters! Password is truncated!");
      pwd.value = pwd.value.substr(0, 32);
      pwd.select();
   }
}
// done hiding -->
</script>
   </head>
   <body>
      <blockquote>
         <form>
            <b>Access Control -- Passwords</b><br><br>
            Use the fields below to enter 8 to 32 characters and click "Apply/Save" to change or create passwords.<br>
            Note: Don't use spaces at the beginning or end of the password. Nor enter multiple consecutive spaces.<br><br>
            <table border="0" cellpadding="0" cellspacing="0">
               <tr>
                  <td>Old Password:</td>
                  <td><input name='pwdOld' type="password" size="20"></td>
               </tr>
               <tr>
                  <td>New Password:</td>
                  <td><input name='pwdNew' type="password" size="20" onchange="checkLength(this)" onpaste="checkLength(this)" onkeyup="checkLength(this)" onmouseup="checkLength(this)"></td>
               </tr>
               <tr>
                  <td>Confirm Password:</td>
                  <td><input name='pwdCfm' type='password' size="20"></td>
               </tr>
            </table>
            <br>
            <center><input type='button' onClick='btnApply()' value='Apply/Save'></center>
         </form>
      </blockquote>
   </body>
</html>
